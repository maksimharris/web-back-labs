{% extends "base.html" %}

{% block lab %}–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 8{% endblock %}

{% block main %}
<style>
    .edit-wrapper {
        min-height: 80vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .edit-card {
        width: 100%;
        max-width: 700px;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        border: 1px solid rgba(255, 255, 255, 0.3);
    }
    
    .edit-header {
        text-align: center;
        margin-bottom: 30px;
    }
    
    .edit-header h1 {
        font-size: 32px;
        color: #333;
        margin-bottom: 10px;
        font-weight: 700;
    }
    
    .edit-header .subtitle {
        color: #666;
        font-size: 16px;
    }
    
    .form-grid {
        display: grid;
        gap: 25px;
    }
    
    .form-group {
        position: relative;
    }
    
    .form-label {
        display: block;
        margin-bottom: 8px;
        color: #444;
        font-weight: 600;
        font-size: 14px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    
    .form-input, .form-textarea {
        width: 100%;
        padding: 14px 16px;
        border: 2px solid #e1e5e9;
        border-radius: 12px;
        font-size: 16px;
        transition: all 0.3s ease;
        background: white;
        box-sizing: border-box;
    }
    
    .form-input:focus, .form-textarea:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }
    
    .form-textarea {
        min-height: 250px;
        resize: vertical;
        line-height: 1.6;
    }
    
    .options-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin: 25px 0;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 12px;
    }
    
    .option-item {
        display: flex;
        align-items: center;
        gap: 12px;
    }
    
    .custom-checkbox {
        width: 24px;
        height: 24px;
        border: 2px solid #ddd;
        border-radius: 6px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
    }
    
    .custom-checkbox.checked {
        background: #667eea;
        border-color: #667eea;
    }
    
    .custom-checkbox.checked::after {
        content: "‚úì";
        color: white;
        font-weight: bold;
    }
    
    .checkbox-input {
        display: none;
    }
    
    .option-label {
        font-size: 16px;
        color: #555;
        cursor: pointer;
        user-select: none;
    }
    
    .form-actions {
        display: flex;
        gap: 15px;
        margin-top: 30px;
    }
    
    .btn-save {
        flex: 1;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 16px;
        border-radius: 12px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .btn-save:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
    }
    
    .btn-cancel {
        background: #f8f9fa;
        color: #666;
        border: 2px solid #e1e5e9;
        padding: 16px 24px;
        border-radius: 12px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        text-decoration: none;
        text-align: center;
        transition: all 0.3s ease;
    }
    
    .btn-cancel:hover {
        background: #e9ecef;
        border-color: #dee2e6;
    }
    
    .error-message {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
        padding: 16px;
        border-radius: 12px;
        margin-bottom: 25px;
        display: flex;
        align-items: center;
        gap: 12px;
        animation: slideIn 0.3s ease;
    }
    
    .error-message::before {
        content: "‚ö†Ô∏è";
        font-size: 20px;
    }
    
    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    @media (max-width: 768px) {
        .edit-card {
            padding: 25px;
        }
        
        .options-grid {
            grid-template-columns: 1fr;
        }
        
        .form-actions {
            flex-direction: column;
        }
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // –ê–Ω–∏–º–∞—Ü–∏—è —á–µ–∫–±–æ–∫—Å–æ–≤
        const checkboxes = document.querySelectorAll('.checkbox-input');
        checkboxes.forEach(checkbox => {
            const container = checkbox.parentElement.querySelector('.custom-checkbox');
            if (checkbox.checked) {
                container.classList.add('checked');
            }
            
            checkbox.addEventListener('change', function() {
                if (this.checked) {
                    container.classList.add('checked');
                } else {
                    container.classList.remove('checked');
                }
            });
            
            container.addEventListener('click', function() {
                checkbox.click();
            });
        });
        
        // –ü–æ–¥—Å—á–µ—Ç —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞
        const titleInput = document.getElementById('title');
        const titleCounter = document.createElement('div');
        titleCounter.className = 'char-counter';
        titleCounter.style.cssText = `
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 12px;
            color: #666;
            background: white;
            padding: 2px 6px;
            border-radius: 10px;
        `;
        titleInput.parentElement.style.position = 'relative';
        titleInput.parentElement.appendChild(titleCounter);
        
        function updateCounter() {
            const length = titleInput.value.length;
            titleCounter.textContent = `${length}/50`;
            
            if (length > 45) {
                titleCounter.style.color = '#f5576c';
                titleCounter.style.fontWeight = 'bold';
            } else {
                titleCounter.style.color = '#666';
                titleCounter.style.fontWeight = 'normal';
            }
        }
        
        titleInput.addEventListener('input', updateCounter);
        updateCounter();
        
        // –ü–æ–¥—Å—á–µ—Ç —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è —Ç–µ–∫—Å—Ç–∞
        const textarea = document.getElementById('article_text');
        const textCounter = document.createElement('div');
        textCounter.className = 'char-counter';
        textCounter.style.cssText = `
            position: absolute;
            right: 10px;
            bottom: 10px;
            font-size: 12px;
            color: #666;
            background: white;
            padding: 2px 6px;
            border-radius: 10px;
        `;
        textarea.parentElement.style.position = 'relative';
        textarea.parentElement.appendChild(textCounter);
        
        function updateTextCounter() {
            const length = textarea.value.length;
            textCounter.textContent = `${length} —Å–∏–º–≤–æ–ª–æ–≤`;
        }
        
        textarea.addEventListener('input', updateTextCounter);
        updateTextCounter();
    });
</script>

<div class="edit-wrapper">
    <div class="edit-card">
        <div class="edit-header">
            <h1>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏</h1>
            <div class="subtitle">–í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç</div>
        </div>
        
        {% if error %}
            <div class="error-message">{{ error }}</div>
        {% endif %}
        
        <form action="/lab8/edit/{{ article.id }}" method="post" class="form-grid">
            <div class="form-group">
                <label class="form-label" for="title">–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–∞—Ç—å–∏</label>
                <input type="text" id="title" name="title" class="form-input" 
                       value="{{ article.title }}" required maxlength="50"
                       placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–∞—Ç—å–∏">
            </div>
            
            <div class="form-group">
                <label class="form-label" for="article_text">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ</label>
                <textarea id="article_text" name="article_text" class="form-textarea" required
                          placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—å–∏...">{{ article.article_text }}</textarea>
            </div>
            
            <div class="options-grid">
                <div class="option-item">
                    <input type="checkbox" id="is_favorite" name="is_favorite" 
                           class="checkbox-input" {% if article.is_favorite %}checked{% endif %}>
                    <div class="custom-checkbox {% if article.is_favorite %}checked{% endif %}"></div>
                    <label for="is_favorite" class="option-label">
                        <strong>–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</strong>
                        <div style="font-size: 14px; color: #888; margin-top: 2px;">
                            –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
                        </div>
                    </label>
                </div>
                
                <div class="option-item">
                    <input type="checkbox" id="is_public" name="is_public" 
                           class="checkbox-input" {% if article.is_public %}checked{% endif %}>
                    <div class="custom-checkbox {% if article.is_public %}checked{% endif %}"></div>
                    <label for="is_public" class="option-label">
                        <strong>–°–¥–µ–ª–∞—Ç—å –ø—É–±–ª–∏—á–Ω–æ–π</strong>
                        <div style="font-size: 14px; color: #888; margin-top: 2px;">
                            –í–∏–¥–Ω–∞ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
                        </div>
                    </label>
                </div>
            </div>
            
            <div class="form-actions">
                <button type="submit" class="btn-save">
                    üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                </button>
                <a href="/lab8/articles" class="btn-cancel">
                    ‚Ü©Ô∏è –û—Ç–º–µ–Ω–∞
                </a>
            </div>
        </form>
    </div>
</div>
{% endblock %}