{% extends "base.html" %}

{% block lab %}–í—Ö–æ–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞{% endblock %}

{% block script %}
<style>
    body {
        background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 0;
    }

    .login-container {
        background-color: white;
        padding: 40px;
        border-radius: 15px;
        box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        width: 100%;
        max-width: 400px;
        animation: slideUp 0.5s ease;
    }

    @keyframes slideUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    h1 {
        color: #333;
        text-align: center;
        margin-bottom: 30px;
        font-size: 2rem;
    }

    .form-group {
        margin-bottom: 20px;
    }

    label {
        display: block;
        margin-bottom: 8px;
        color: #555;
        font-weight: 600;
    }

    input {
        width: 100%;
        padding: 12px;
        border: 2px solid #ddd;
        border-radius: 8px;
        font-size: 16px;
        transition: border-color 0.3s;
    }

    input:focus {
        outline: none;
        border-color: #6a11cb;
    }

    .login-btn {
        width: 100%;
        padding: 14px;
        background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.3s, box-shadow 0.3s;
        margin-top: 10px;
    }

    .login-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(106, 17, 203, 0.3);
    }

    .login-btn:active {
        transform: translateY(0);
    }

    .back-link {
        display: block;
        text-align: center;
        margin-top: 20px;
        color: #666;
        text-decoration: none;
        transition: color 0.3s;
    }

    .back-link:hover {
        color: #6a11cb;
    }

    .demo-credentials {
        background-color: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        margin-top: 20px;
        border-left: 4px solid #6a11cb;
    }

    .demo-credentials h3 {
        color: #333;
        margin-bottom: 10px;
        font-size: 1rem;
    }

    .demo-credentials p {
        color: #666;
        margin: 5px 0;
        font-size: 0.9rem;
    }

    .error-message {
        background-color: #ffebee;
        color: #c62828;
        padding: 12px;
        border-radius: 8px;
        margin-bottom: 20px;
        text-align: center;
        display: none;
    }

    .success-message {
        background-color: #e8f5e9;
        color: #2e7d32;
        padding: 12px;
        border-radius: 8px;
        margin-bottom: 20px;
        text-align: center;
        display: none;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('login-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            const errorDiv = document.getElementById('error-message');
            const successDiv = document.getElementById('success-message');
            
            errorDiv.style.display = 'none';
            successDiv.style.display = 'none';
            
            try {
                const response = await fetch('/rgz/json-rpc-api/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        jsonrpc: '2.0',
                        method: 'login_admin',
                        params: {
                            username: username,
                            password: password
                        },
                        id: 1
                    })
                });
                
                const data = await response.json();
                
                if (data.error) {
                    errorDiv.textContent = data.error.message;
                    errorDiv.style.display = 'block';
                } else {
                    successDiv.textContent = '–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥! –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ...';
                    successDiv.style.display = 'block';
                    
                    setTimeout(() => {
                        window.location.href = '/rgz/admin/books';
                    }, 1000);
                }
            } catch (error) {
                errorDiv.textContent = '–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É';
                errorDiv.style.display = 'block';
                console.error('Login error:', error);
            }
        });
    });
</script>
{% endblock %}

{% block main %}
    <div class="login-container">
        <h1>üîê –í—Ö–æ–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h1>
        
        <div id="error-message" class="error-message"></div>
        <div id="success-message" class="success-message"></div>

        <div class="demo-credentials">
            <h3>–î–µ–º–æ-–¥–æ—Å—Ç—É–ø:</h3>
            <p><strong>–õ–æ–≥–∏–Ω:</strong> admin</p>
            <p><strong>–ü–∞—Ä–æ–ª—å:</strong> admin123</p>
        </div>

        <form id="login-form">
            <div class="form-group">
                <label for="username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                <input type="text" id="username" name="username" required>
            </div>
            
            <div class="form-group">
                <label for="password">–ü–∞—Ä–æ–ª—å:</label>
                <input type="password" id="password" name="password" required>
            </div>
            
            <button type="submit" class="login-btn">–í–æ–π—Ç–∏</button>
        </form>
        
        <a href="/rgz/" class="back-link">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>
    </div>
{% endblock %}